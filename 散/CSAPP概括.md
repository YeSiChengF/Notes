# CSAPP概括

## 计算机漫游

### 程序编译过程

#### 预处理

预处理器根据#开头的头文件，读取头文件内容插入源程序中，得到另外一个c程序。

预处理后的文件通常以  .i结尾，文本文件

#### 编译

词法分析、语法分析、语义分析

编译后的文件以 .s结尾，文本文件

#### 汇编

根据编译后的文件翻译成机器指令，并将这些机器指令按照固定规则进行打包。

汇编后的文件以 .o结尾 ，可重定位目标文件，还不能执行

#### 链接

链接器(Id)负责把引用的已编译程序.o结尾和当前程序.o结尾进行合并。

汇编后的文件为可重定位文件，在链接阶段进行链接

### 了解编译过程的目的

优化程序性能

理解链接时出现的错误

避免安全漏洞

### 计算机硬件组成

#### CPU

###### PC

PC是CPU中，大小为1个字的存储区域，为某一条指令的地址。从系统上电的瞬间，直到系统断点。处理器便不断执行PC指向的指令，然后更新PC，使其指向下一条要执行的指令。

当前指令和下一条要执行的指令不一定是相邻的。

1个字在32位机器中为4个字节，在64位机器中为8个字节

###### 寄存器文件

由一些单字长的寄存器构成，每个寄存器都有唯一的名字。

临时存放数据的空间

处理器从内存中读取A的值暂存于寄存器X中，读取B的值存储于寄存器Y中。

![1639932424667](C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\1639932424667.png)

###### ALU算数逻辑单元

运算：将寄存器中的进行赋值，再进行算术运算，得到的结果会保存到寄存器X或寄存器Y中，寄存器中原来的数值会被新的覆盖。

#### 主存(内存)

存放指令和数据，物理上内容由随机动态存储器芯片组成。

逻辑上为从0开始的大数组，每个字节都有相应地址。

内存与CPU之间通过总线进行数据传递。

总线通常为传输固定长度的字节块，也就是字(word)

##### 输入过程

![1639933274750](C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\1639933274750.png)

##### 输出过程

读取数据

![1639933344828](C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\1639933344828.png)

复制过程使用DMA技术，数据可以不经过处理器， 从磁盘直接到达内存。

输出

![1639933440219](C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\1639933440219.png)

##### 高速缓存cache

寄存器和内存读取速度差异较大，通过高速缓存进行缓冲。

一般有3级缓存。

L0为寄存器文件

L1 cache，访问速度与访问寄存器文件几乎一样快。容量为数万字节(10~100kb)

L2 cache，L1速度是L2的5倍。容量为数十万到数百万字节。(0.1~10MB)

L3 cache，比L2慢。(10~100MB)

#### 存储器结构

![1639933907633](C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\1639933907633.png)

主要思想为，上一层存储设备是下一层存储设备的高速缓存，**可以利用存储器的存储结构来提升程序性能。**

