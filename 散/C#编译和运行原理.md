# C#编译和运行原理

https://www.cnblogs.com/Tpf386/p/6479675.html

## 编译与内存的关系

**全局变量、静态变量(包含一些复杂类型的常量)**，所需的空间大小可以明确计算并且不会发生改变，所以可以**直接存储在可执行文件的特定的节**中(包含初始化的值)。

程序运行时，直接将这个节加载到特定的段中，不必在程序运行期间用额外代买来产生这些变量。

编译分配空间，准确来说是编译期间编译器为你规划好了这些变量的内存使用方案，这个方案写到可执行文件内，直到程序运行才拿出来执行。

## 编译

编译是一个扫描过程，进行词法语法检查，代码优化。

编译时赋初值，只是形成文本检查无错误，并没有分配内存。当运行时，系统才将程序导入内存中。

一个进程(运行的程序)主要包括五个分区：

栈区、堆区、全局数据区/静态区、代码区、常量区

- 栈区用来存放局部数据或者是函数的参数，函数的返回值之类的变量（其中还有返回到调用函数下一条指令的地址）
- 堆区用来存放程序中动态申请内存的变量
- 全局变量/静态区用来存放程序中的全局变量或者是静态变量，因为它们的大小是确定的，在编译期间就已经进行静态空间的分配，而且不会改变，这样会提高程序对这些数据的访问速度
- 代码区（code）用来存放编译后的二进制代码
- 常量区用来存放我们声明的常量（const类型）

## 小结

编译时不分配内存，程序只有执行时才进行内存分配。