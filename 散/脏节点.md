# 脏标记

原始数据随着时间变化，其衍生数据需要一系列操作后才能进行改变的。在不必要的时候进行操作必定造成性能消耗。

在对原始数据进行改变时，标记为脏；在需要使用衍生数据时，再计算并清除脏标记。

### 使用场景

原始数据的修改次数比衍生数据的使用次数多。

递增地更新数据十分困难，因而需要脏标记来按需更新衍生数据。

### 注意事项

- 必须保证每次原始数据改动时，都设置脏标记

- 必须在内存中保存上次的衍生数据。因为在张标记没有被设置时，是直接读取上次的衍生数据


## 红点系统

在红点系统中，当子节点数据发生改变时一直向上通知父节点改变数值。如果当前节点有4个子节点，4个子节点都发生了改变，当前节点就需要被通知4次，如果层次越多深度越深则需要被通知的次数也越多次。必定会造成性能不必要的消耗，如在状态多变的界面(主界面)可能发生卡顿。

![1638870987766](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\1638870987766.png)

使用脏标记的想法，在子节点发生改变时将父节点标记为脏节点，在需要使用父节点时再进行脏节点的操作。

